<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="If you're looking for concise and on-topic programming tutorials and notes with examples, you are in the right place! Here, you'll find tutorials on Python, Java, C++, web development, and databases. This website is a personal portfolio built and maintained by a single creator.">
    <meta name="keywords" content="Programming, Coding, Python, Web Development, C++, HTML Tutorial, CSS Tutorial, Bootstrap Tutorial, Python Tutorial, C++ Tutorial, HTML, CSS, Bootstrap, Software Development, Algorithms, Data Structures, Programming Tutorials, Coding Tips, Code Examples, Programming Resources, Learn Python, Programming Beginner To Expert, Coding Community, Online Coding Courses, MS Access, Databases, OOP, Object Oriented Programming, IT, Computer Science, Data Science, AI, Django, TensorFlow, Java, Java Tutorial, Android, Android Studio, Kotlin, Electronics, Binary">
    <meta name="author" content="Tymoteusz KoÅ‚odziejczyk">
    <link href="font/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="files/logo.png" rel="icon">
    <link href="files/logo.png" rel="apple-touch-icon">
    <link rel="stylesheet" href="css/fontello.css" type="text/css">
    <link rel="stylesheet" href="css/styles.css" type="text/css">
    <title>Metaclasses</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D76ZFDYLCY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-D76ZFDYLCY');
    </script>
</head>

<body id="page-top">
    <div id="wrapper">
        <ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar" style="background-color: #157267;">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                    <img src="files/logo.png" alt="Logo" id="logo">
                <div class="sidebar-brand-text mx-3">CPUcademy</div>
            </a>
            
            <hr class="sidebar-divider my-0">
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="icon-home"></i>
                    <span>Home</span></a>
            </li>
            <hr class="sidebar-divider" style="margin-bottom: 0px;">
    
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="icon-th-list"></i>
                    <span>Tutorials</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="python.html">Python</a>
                        <a class="collapse-item" href="java.html">Java &amp; Kotlin (Android)</a>
                        <a class="collapse-item" href="cplusplus.html">C++</a>
                        <a class="collapse-item" href="web.html">Basic web stack</a>
                        <a class="collapse-item" href="databases.html">Databases</a>
                        <a class="collapse-item" href="electronics.html">Electronics</a>
                        <a class="collapse-item" href="it-and-computer-basics.html">IT &amp; computer basics</a>
                    </div>
                </div>
            </li>
            <hr class="sidebar-divider">
            <div class="sidebar-heading">About me</div>
            
            <li class="nav-item">
                <a class="nav-link" href="cv.html">
                    <i class="icon-adult"></i>
                    <span>CV</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="portfolio-projects.html">
                    <i class="icon-docs"></i>
                    <span>Portfolio projects</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="services.html">
                    <i class="icon-services"></i>
                    <span>My services</span></a>
            </li>
            <hr class="sidebar-divider">
        </ul>

        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars" style="color: #157267;"></i>
                </button>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 mb-4">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h5 class="m-0 font-weight-bold">Metaclasses</h5>
                                </div>
                                <div class="card-body">
                                    <p>If you do not mind, please read this article on <a href="https://medium.com/@cpucademy/metaclasses-in-python-no-bs-guide-b8fcf7fb10d0" target="_blank" class="link">Medium</a>.</p>

                                    <p>We can do something like the example below because classes are also objects.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">def</span> fun():
    <span class="function">class</span> C:
        <span class="function">pass</span>
    <span class="function">return</span> C
                                    </code></pre>

                                    <p>Every object needs a higher-level object (such as a class or metaclass) to define its structure and behavior. A class is that object for its instances (it defines its attributes), and a metaclass is that object for a class itself. An instance of a metaclass is a class. They are always working automatically in the background, and today, we will learn how to leverage them for our purposes.</p>

                                    <p>The type of a class is <code>&lt;class 'type'&gt;</code>. <code>type</code> is what defines the rules and creates the class. It is a metaclass. Whenever we write a class, we call the <code>type</code> constructor that creates the class object.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">class</span> C:
    <span class="function">def</span> method(<span class="function">self</span>):
        <span class="command">print</span>(<span class="text">"Method"</span>)

<span class="command">print</span>(<span class="function">C</span>()) <span class="comment"># &lt;__main__.C object at ...&gt; (an instance of a class)</span>
<span class="command">print</span>(<span class="function">type</span>(<span class="function">C</span>())) <span class="comment"># &lt;class '__main__.C'&gt; (type of a class instance)</span>
<span class="command">print</span>(<span class="function">type</span>(<span class="function">C</span>)) <span class="comment"># &lt;class 'type'&gt; (type of a class itself)</span>
                                    </code></pre>

                                    <p>This means that we can create a class using the <code>type()</code> function directly, as shown below. The parameters of the <code>type()</code> function are: the class name, a tuple of classes it inherits from (its bases), and a dictionary of attributes.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">def</span> method(<span class="function">self</span>):
    <span class="function">self</span>.y <span class="sign">=</span> 3

C <span class="sign">=</span> <span class="function">type</span>(<span class="text">"C"</span>, (), {<span class="text">"x"</span>: 3, <span class="text">"method"</span>: method}) <span class="comment"># we write the function name without parentheses because we want to get a callable function object and not call it right away</span>
cc <span class="sign">=</span> <span class="function">C</span>()
<span class="command">print</span>(cc.x)

cc.method()
<span class="command">print</span>(cc.y)

<span class="command">print</span>(<span class="function">C</span>()) <span class="comment"># &lt;__main__.C object at ...&gt;</span>
                                    </code></pre>

                                    <h4>Creating a metaclass</h4>

                                    <p>All metaclasses have to inherit from <code>type</code>. Inside them, we use the <code>__new__()</code> dunder method. It is called before the <code>__init__()</code> method and defines how the object itself is constructed (<code>__init__()</code> initializes it, defines its attributes, etc.) This method has to return a <code>type</code> object so the class is created. When used inside a metaclass, we can utilize it to change the structure of the classes using this metaclass. In the example below, we change nothing but only print the attributes of the <code>C</code> class.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">class</span> Meta(<span class="function">type</span>):
    <span class="function">def __new__</span>(<span class="function">self</span>, class_name, bases, attributes):
        <span class="command">print</span>(attributes)
        <span class="function">return</span> <span class="function">type</span>(class_name, bases, attributes)

<span class="function">class</span> C(<span class="command">metaclass</span> <span class="sign">=</span> <span class="function">Meta</span>):
    x <span class="sign">=</span> 5
    y <span class="sign">=</span> 8
    <span class="function">def</span> method(<span class="function">self</span>):
        <span class="command">print</span>(<span class="text">"Method"</span>)

c <span class="sign">=</span> <span class="function">C</span>() <span class="comment"># even without an instance, the attributes would still be printed out because the class object itself was created</span>
<span class="command">print</span>(c.x) <span class="comment"># 5</span>
                                    </code></pre>

                                    <p>Below, we can see an example of how we can modify the class structure from the metaclass. We swap the <code>x</code> and <code>y</code> attributes, and even though the <code>x</code> is defined as 5 in the class, when we print it, the result will be 8. We could also, e.g., change all attributes to uppercase (except dunder methods like <code>__qualname__()</code> which represents the class name). This is just an example useless in real-world applications, but it effectively shows how metaclasses work.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">class</span> Meta(<span class="function">type</span>):
    <span class="function">def __new__</span>(<span class="function">self</span>, class_name, bases, attributes):
        <span class="command">print</span>(attributes)
        attrs <span class="sign">=</span> {}
        <span class="function">for</span> name, value <span class="function">in</span> attributes.<span class="command">items</span>():
            <span class="function">if</span> name <span class="sign">==</span> <span class="text">"x"</span>:
                attrs[<span class="text">"y"</span>] <span class="sign">=</span> value <span class="comment"># assigning the value of "x" to "y"</span>
            <span class="function">elif</span> name <span class="sign">==</span> <span class="text">"y"</span>:
                attrs[<span class="text">"x"</span>] <span class="sign">=</span> value <span class="comment"># assigning the value of "y" to "x"</span>
            <span class="function">else</span>:
                attrs[name] <span class="sign">=</span> value

        <span class="command">print</span>(attrs)
        <span class="function">return</span> <span class="function">type</span>(class_name, bases, attrs)

<span class="function">class</span> C(<span class="command">metaclass</span> <span class="sign">=</span> <span class="function">Meta</span>):
    x <span class="sign">=</span> 5
    y <span class="sign">=</span> 8
    <span class="function">def</span> method(<span class="function">self</span>):
        <span class="command">print</span>(<span class="text">"Method"</span>)

c <span class="sign">=</span> <span class="function">C</span>()
<span class="command">print</span>(c.x) <span class="comment"># 8</span>
                                    </code></pre>

                                    <h4>Real-world applications</h4>

                                    <p>Metaclasses are not commonly used in everyday programming, but they become necessary in certain situations, such as when we have to add mandatory attributes (variables or methods) to every class or enforce specific rules across multiple classes. They are primarily used in the development of libraries or frameworks. The example below shows how we can add a default method to every class using our metaclass.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">class</span> Meta(<span class="function">type</span>):
    <span class="function">def __new__</span>(<span class="function">self</span>, class_name, bases, attributes):
        <span class="function">def</span> getX(<span class="function">self</span>):
            <span class="function">return</span> <span class="command">getattr</span>(<span class="function">self</span>, <span class="text">f"_{class_name}__x"</span>) <span class="comment"># accessing the private attribute</span>

        attributes[<span class="text">"getX"</span>] <span class="sign">=</span> getX
        <span class="function">return</span> <span class="function">type</span>(class_name, bases, attributes)

<span class="function">class</span> C(<span class="command">metaclass</span> <span class="sign">=</span> <span class="function">Meta</span>):
    <span class="function">def __init__</span>(<span class="function">self</span>):
        <span class="function">self</span>.__x <span class="sign">=</span> 5

<span class="function">class</span> D(<span class="command">metaclass</span> <span class="sign">=</span> <span class="function">Meta</span>):
    <span class="function">def __init__</span>(<span class="function">self</span>):
        <span class="function">self</span>.__x <span class="sign">=</span> 4

c <span class="sign">=</span> <span class="function">C</span>()
<span class="command">print</span>(c.getX())

d <span class="sign">=</span> <span class="function">D</span>()
<span class="command">print</span>(d.getX())
                                    </code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; CPUcademy All Rights Reserved | <a href="license-and-sources.html" class="link">License &amp; Sources</a></span>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="configs/jquery/jquery.min.js"></script>
    <script src="configs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="configs/script.js"></script>
</body>
</html>