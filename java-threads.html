<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="If you're looking for concise and on-topic programming tutorials and notes with examples, you are in the right place! Here, you'll find tutorials on Python, Java, C++, web development, and databases. This website is a personal portfolio built and maintained by a single creator.">
    <meta name="keywords" content="Programming, Coding, Python, Web Development, C++, HTML Tutorial, CSS Tutorial, Bootstrap Tutorial, Python Tutorial, C++ Tutorial, HTML, CSS, Bootstrap, Software Development, Algorithms, Data Structures, Programming Tutorials, Coding Tips, Code Examples, Programming Resources, Learn Python, Programming Beginner To Expert, Coding Community, Online Coding Courses, MS Access, Databases, OOP, Object Oriented Programming, IT, Computer Science, Data Science, AI, Django, TensorFlow, Java, Java Tutorial, Android, Android Studio, Kotlin, Electronics, Binary">
    <meta name="author" content="Tymoteusz Kołodziejczyk">
    <link href="font/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="files/logo.png" rel="icon">
    <link href="files/logo.png" rel="apple-touch-icon">
    <link rel="stylesheet" href="css/fontello.css" type="text/css">
    <link rel="stylesheet" href="css/styles.css" type="text/css">
    <title>Threads</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D76ZFDYLCY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-D76ZFDYLCY');
    </script>
</head>

<body id="page-top">
    <div id="wrapper">
        <ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar" style="background-color: #157267;">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                    <img src="files/logo.png" alt="Logo" id="logo">
                <div class="sidebar-brand-text mx-3">CPUcademy</div>
            </a>
            
            <hr class="sidebar-divider my-0">
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="icon-home"></i>
                    <span>Home</span></a>
            </li>
            <hr class="sidebar-divider" style="margin-bottom: 0px;">
    
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="icon-th-list"></i>
                    <span>Tutorials</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="python.html">Python</a>
                        <a class="collapse-item" href="java.html">Java &amp; Kotlin (Android)</a>
                        <a class="collapse-item" href="cplusplus.html">C++</a>
                        <a class="collapse-item" href="web.html">Basic web stack</a>
                        <a class="collapse-item" href="databases.html">Databases</a>
                        <a class="collapse-item" href="electronics.html">Electronics</a>
                        <a class="collapse-item" href="it-and-computer-basics.html">IT &amp; computer basics</a>
                    </div>
                </div>
            </li>
            <hr class="sidebar-divider">
            <div class="sidebar-heading">About me</div>
            
            <li class="nav-item">
                <a class="nav-link" href="cv.html">
                    <i class="icon-adult"></i>
                    <span>CV</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="portfolio-projects.html">
                    <i class="icon-docs"></i>
                    <span>Portfolio projects</span></a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="services.html">
                    <i class="icon-services"></i>
                    <span>My services</span></a>
            </li>
            <hr class="sidebar-divider">
        </ul>

        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars" style="color: #157267;"></i>
                </button>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 mb-4">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h5 class="m-0 font-weight-bold">Threads</h5>
                                </div>
                                <div class="card-body">
                                    <p>Threads are a fundamental part of the Java concurrency model, allowing multiple tasks to run simultaneously within a single program. By utilizing threads, we can create more responsive and efficient applications, particularly in scenarios where tasks can be performed in parallel. Java provides built-in support for multithreading through the <code>Thread</code> class or the <code>Runnable</code> interface (with <code>Thread</code> being used under the hood).</p>

                                    <p>To create a thread, we extend the <code>Thread</code> class and override its <code>run()</code> method, which contains the code to be executed by the thread. Once the thread is created, it can be started using the <code>start()</code> method. The <code>join()</code> method ensures the program waits until the chosen thread completes execution before proceeding further. It is useful because some resources may be necessary for the rest of the program. Threads can be also put to sleep using the <code>Thread.sleep(milliseconds)</code> method, allowing for controlled pauses in execution.</p>

                                    <p>Java also provides higher-level concurrency utilities in the <code>java.util.concurrent</code> package, which includes features like thread pools, futures, and concurrent collections, making it easier to manage complex multithreaded applications.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">class</span> Task1 <span class="function">extends Thread</span> <span class="sign">{</span>
    <span class="command">@Override</span>
    <span class="function">public void</span> run() <span class="sign">{</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 1<span class="sign">;</span> i <span class="sign">&lt;=</span> 10000<span class="sign">;</span> i<span class="sign">++</span>) <span class="sign">{</span>
            <span class="function">if</span>(i <span class="sign">==</span> 10000)
                <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Task1: Counted to "</span> <span class="sign">+</span> i)<span class="sign">;</span>
        <span class="sign">}</span>
    <span class="sign">}</span>
<span class="sign">}</span>

<span class="function">class</span> Task2 <span class="function">extends Thread</span> <span class="sign">{</span>
    <span class="command">@Override</span>
    <span class="function">public void</span> run() <span class="sign">{</span>
        <span class="function">int</span> sum <span class="sign">=</span> 0<span class="sign">;</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 1<span class="sign">;</span> i <span class="sign">&lt;=</span> 10000<span class="sign">;</span> i<span class="sign">++</span>)
            sum <span class="sign">+=</span> i<span class="sign">;</span>
        <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Task2: Sum = "</span> <span class="sign">+</span> sum)<span class="sign">;</span>
    <span class="sign">}</span>
<span class="sign">}</span>

<span class="function">public class</span> Main <span class="sign">{</span>
    <span class="function">public static void</span> main(<span class="function">String</span>[] args) <span class="sign">{</span>
        <span class="comment">// Creating threads</span>
        <span class="function">Task1</span> task1 <span class="sign">=</span> <span class="function">new Task1</span>()<span class="sign">;</span>
        <span class="function">Task2</span> task2 <span class="sign">=</span> <span class="function">new Task2</span>()<span class="sign">;</span>

        <span class="comment">// Starting threads</span>
        task1.<span class="command">start</span>()<span class="sign">;</span>
        task2.<span class="command">start</span>()<span class="sign">;</span>

        <span class="function">try</span> <span class="sign">{</span>
            <span class="comment">// Waiting for both threads to finish</span>
            task1.<span class="command">join</span>()<span class="sign">;</span>
            task2.<span class="command">join</span>()<span class="sign">;</span>
        <span class="sign">}</span>
        <span class="function">catch</span>(<span class="function">InterruptedException</span> e) <span class="sign">{</span> <span class="comment">// if another thread interrupts the current thread</span>
            <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Main thread interrupted."</span>)<span class="sign">;</span>
        <span class="sign">}</span>
        <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Both tasks completed."</span>)<span class="sign">;</span>
    <span class="sign">}</span>
<span class="sign">}</span>
                                    </code></pre>     

                                    <p>Of course, using <code>join()</code> is not necessary. We do not use it if we want to start two separate threads that have absolutely nothing to do with each other. However, if we deleted these methods from the example above, the "Both tasks completed." string would display weirdly (check it in your editor) because the compiler would not wait for both threads to display their results before printing it.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="comment">// Creating a thread using a lambda statement</span>
<span class="function">int</span> n <span class="sign">=</span> 20<span class="sign">;</span>
<span class="function">Thread</span> th <span class="sign">=</span> <span class="function">new Thread</span>(() <span class="sign">-> {</span>
    <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Square of "</span> <span class="sign">+</span> n <span class="sign">+</span> <span class="text">" is: "</span> <span class="sign">+</span> square(n))<span class="sign">;</span> <span class="comment">// you have to define the square() method</span>
<span class="sign">}</span>)<span class="sign">;</span>
th.<span class="command">start</span>()<span class="sign">;</span>
                                    </code></pre>

                                    <p>A race condition occurs when multiple threads access shared resources without proper synchronization, leading to unpredictable behavior. A deadlock happens when two or more threads are waiting indefinitely for resources held by each other, preventing further execution. In contrast, a livelock occurs when threads keep changing state in response to each other but make no real progress, as they continuously attempt to resolve the conflict without success. While race conditions lead to incorrect results, deadlocks halt execution, and livelocks keep the system active but unproductive.</p>
                                    
                                    <p>Threads can be synchronized to prevent concurrent access to shared resources, ensuring data consistency. Synchronization is applied using the <code>synchronized</code> keyword. It ensures that only one thread accesses shared resources at a time. Synchronization ensures data consistency but can reduce performance if overused.</p>

                                    <p>In the example below, <code>synchronized</code> prevents multiple threads from modifying the <code>shared_resource</code> variable simultaneously, which could lead to inconsistencies due to race conditions. Without the "lock," threads can interfere with each other while accessing the shared resource, causing the final result to be unpredictable. For example, two threads might read the same value of <code>shared_resource</code>, increment it, and write it back, effectively skipping one increment. This may result in a final value being lower than expected. When a thread enters the <code>synchronized(Main.class)</code> block, it first tries to acquire the lock. If another thread already holds the lock, the current thread will wait until the lock is released. Inside the locked block, the shared resource is modified. Once the other thread finishes modifying <code>shared_resource</code>, the lock is automatically released.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="function">public class</span> Main <span class="sign">{</span>
    <span class="function">private static int</span> shared_resource <span class="sign">=</span> 0<span class="sign">;</span>
    
    <span class="function">public static void</span> main(<span class="function">String</span>[] args) <span class="sign">{</span>
        <span class="comment">// Creating multiple threads</span>
        <span class="function">Thread</span>[] threads <span class="sign">=</span> <span class="function">new Thread</span>[10]<span class="sign">;</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 0<span class="sign">;</span> i <span class="sign">&lt;</span> 10<span class="sign">;</span> i<span class="sign">++</span>) <span class="sign">{</span>
            threads[i] <span class="sign">=</span> <span class="function">new Thread</span>(<span class="function">Main</span><span class="sign">::</span>increment)<span class="sign">;</span> <span class="comment">// the :: operator symbolizes affiliation to the class</span>
            threads[i].<span class="command">start</span>()<span class="sign">;</span>
        <span class="sign">}</span>

        <span class="comment">// Waiting for all threads to finish</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 0<span class="sign">;</span> i <span class="sign">&lt;</span> 10<span class="sign">;</span> i<span class="sign">++</span>) <span class="sign">{</span>
            <span class="function">try</span> <span class="sign">{</span>
                threads[i].<span class="command">join</span>()<span class="sign">;</span>
            <span class="sign">}</span> 
            <span class="function">catch</span>(<span class="function">InterruptedException</span> e) <span class="sign">{</span>
                <span class="function">Thread</span>.<span class="command">currentThread</span>().<span class="command">interrupt</span>()<span class="sign">;</span> <span class="comment">// setting the interrupted status of the current thread</span>
            <span class="sign">}</span>
        <span class="sign">}</span>

        <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Final value of shared_resource: "</span> <span class="sign">+</span> shared_resource)<span class="sign">;</span>
    <span class="sign">}</span>

    <span class="function">public static void</span> increment() <span class="sign">{</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 0<span class="sign">;</span> i <span class="sign">&lt;</span> 1000<span class="sign">;</span> i<span class="sign">++</span>) <span class="sign">{</span>
            <span class="comment">// Ensuring only one thread modifies the shared resource at a time (acquiring the lock before accessing the data) - synchronization</span>
            <span class="function">synchronized</span>(<span class="function">Main</span>.<span class="function">class</span>) <span class="sign">{</span>
                shared_resource<span class="sign">++;</span>
            <span class="sign">}</span>
        <span class="sign">}</span>
    <span class="sign">}</span>
<span class="sign">}</span>
                                    </code></pre>

                                    <h4>Thread pools</h4>

                                    <p>A thread pool is a collection of worker threads that efficiently execute multiple tasks in parallel, reusing threads to avoid the overhead of thread creation.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="command">import</span> java.util.concurrent.ExecutorService<span class="sign">;</span>
<span class="command">import</span> java.util.concurrent.Executors<span class="sign">;</span>

<span class="function">public class</span> Main <span class="sign">{</span>
    <span class="function">public static void</span> main(<span class="function">String</span>[] args) <span class="sign">{</span>
        <span class="function">ExecutorService</span> executor <span class="sign">=</span> <span class="function">Executors</span>.<span class="command">newFixedThreadPool</span>(3)<span class="sign">;</span> <span class="comment">// creating a thread pool with 3 worker threads</span>
        
        <span class="comment">// Submitting 5 tasks to the thread pool</span>
        <span class="function">for</span>(<span class="function">int</span> i <span class="sign">=</span> 1<span class="sign">;</span> i <span class="sign">&lt;=</span> 5<span class="sign">;</span> i<span class="sign">++</span>) 
            executor.<span class="command">submit</span>(<span class="function">new Task</span>(i))<span class="sign">;</span> <span class="comment">// executing the task with argument "i"</span>

        executor.<span class="command">shutdown</span>()<span class="sign">;</span> <span class="comment">// shutting down the executor to stop accepting new tasks</span>
    <span class="sign">}</span>
<span class="sign">}</span>

<span class="function">class</span> Task <span class="function">implements Runnable</span> <span class="sign">{</span> <span class="comment">// class to execute inside the thread pool (it can extend Thread instead of implementing Runnable)</span>
    <span class="function">private final int</span> taskNum<span class="sign">;</span>
    <span class="function">public Task</span>(<span class="function">int</span> taskNum)<span class="sign">{</span><span class="function">this</span>.taskNum <span class="sign">=</span> taskNum<span class="sign">;}</span>

    <span class="command">@Override</span>
    <span class="function">public void</span> run() <span class="sign">{</span>
        <span class="function">System</span>.<span class="command">out</span>.<span class="command">println</span>(<span class="text">"Task "</span> <span class="sign">+</span> taskNum <span class="sign">+</span> <span class="text">" running in "</span> <span class="sign">+</span> <span class="function">Thread</span>.<span class="command">currentThread</span>().<span class="command">getName</span>())<span class="sign">;</span>
    <span class="sign">}</span>
<span class="sign">}</span>
                                    </code></pre>

                                    <h4>Semaphore</h4>

                                    <p>Unlike a lock, a semaphore allows a specified number of threads to access a resource at the same time. It ensures mutual exclusion based on the defined limit. When setting the semaphore limit to 2, exactly two threads can access the resource simultaneously.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; CPUcademy All Rights Reserved | <a href="license-and-sources.html" class="link">License &amp; Sources</a></span>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="configs/jquery/jquery.min.js"></script>
    <script src="configs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="configs/script.js"></script>
</body>
</html>