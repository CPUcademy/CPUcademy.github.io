<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="If you're looking for concise and on-topic programming tutorials and notes with examples, you are in the right place! Here, you'll find tutorials on Python, Java, C++, web development, and databases. This website is a personal portfolio built and maintained by a single creator.">
    <meta name="keywords" content="Programming, Coding, Python, Web Development, C++, HTML Tutorial, CSS Tutorial, Bootstrap Tutorial, Python Tutorial, C++ Tutorial, HTML, CSS, Bootstrap, Software Development, Algorithms, Data Structures, Programming Tutorials, Coding Tips, Code Examples, Programming Resources, Learn Python, Programming Beginner To Expert, Coding Community, Online Coding Courses, MS Access, Databases, OOP, Object Oriented Programming, IT, Computer Science, Data Science, AI, Django, TensorFlow, Java, Java Tutorial, Android, Android Studio, Kotlin, Electronics, Binary">
    <meta name="author" content="Tymoteusz Kołodziejczyk">
    <link href="font/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="files/logo.png" rel="icon">
    <link href="files/logo.png" rel="apple-touch-icon">
    <link rel="stylesheet" href="css/fontello.css" type="text/css">
    <link rel="stylesheet" href="css/styles.css" type="text/css">
    <title>Public key cipher</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D76ZFDYLCY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-D76ZFDYLCY');
    </script>
</head>

<body id="page-top">
    <div id="wrapper">
        <ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar" style="background-color: #157267;">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                    <img src="files/logo.png" alt="Logo" id="logo">
                <div class="sidebar-brand-text mx-3">CPUcademy</div>
            </a>
            
            <hr class="sidebar-divider my-0">
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="icon-home"></i>
                    <span>Home</span></a>
            </li>
            <hr class="sidebar-divider" style="margin-bottom: 0px;">
    
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="icon-th-list"></i>
                    <span>Tutorials</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="python.html">Python</a>
                        <a class="collapse-item" href="java.html">Java &amp; Android</a>
                        <a class="collapse-item" href="cplusplus.html">C++</a>
                        <a class="collapse-item" href="web.html">Basic web stack</a>
                        <a class="collapse-item" href="databases.html">Databases</a>
                        <a class="collapse-item" href="electronics-and-it-basics.html">Electronics &amp; IT basics</a>
                    </div>
                </div>
            </li>
            <hr class="sidebar-divider my-0">
            <li class="nav-item">
                <a class="nav-link" href="about-me.html">
                    <i class="icon-adult"></i>
                    <span>About me</span></a>
            </li>
            <hr class="sidebar-divider my-0">
            <li class="nav-item">
                <a class="nav-link" href="portfolio-projects.html">
                    <i class="icon-docs"></i>
                    <span>Portfolio projects</span></a>
            </li>
            <hr class="sidebar-divider">
        </ul>

        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars" style="color: #157267;"></i>
                </button>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 mb-4">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h5 class="m-0 font-weight-bold">Public key cipher</h5>
                                </div>
                                <div class="card-body">
                                    <p>Public-key cryptography (asymmetric cryptography) uses a mathematically linked key pair: a <b>public key</b> that anyone may use to encrypt data, and a <b>private key</b> that must remain secret and is required for decryption. This allows secure communication without a pre‑shared secret. Its security relies on one‑way mathematical problems that are easy to compute but extremely hard to reverse, such as integer factorization (RSA), discrete logarithms (Diffie–Hellman), and elliptic‑curve discrete logarithms (ECC). Because the private key is never transmitted, intercepted ciphertexts cannot be decrypted with the public key alone.</p>

                                    <p>The public key is derived from the private key in a way that is easy to compute but infeasible to invert. For example, a 2048‑bit RSA key corresponds to an astronomically large key space (the full set of all keys that could theoretically be generated), making brute‑force attacks unrealistic. This structure enables encryption, digital signatures, and key‑exchange protocols without requiring shared secrets.</p>

                                    <p>Although slower than symmetric encryption and dependent on the continued hardness of its mathematical assumptions, public‑key cryptography is widely used and foundational to modern security technologies such as HTTPS, digital certificates, secure email, and many authentication systems.</p>

                                    <p>Man‑in‑the‑middle attacks (MITM) remain a practical risk: if an attacker can intercept and replace public keys during exchange, they can decrypt or alter messages while appearing legitimate. This is why authenticated key distribution (via certificates, trusted authorities, or verified fingerprints) is essential, since public‑key cryptography alone cannot prevent key substitution.</p>

                                    <p>The <code>cryptography</code> module provides robust tools for implementing this cipher.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="command">from</span> cryptography.hazmat.primitives.asymmetric <span class="command">import</span> rsa, padding
<span class="command">from</span> cryptography.hazmat.primitives <span class="command">import</span> serialization, hashes

<span class="comment">#### Generating the public and private keys ####</span>

private_key <span class="sign">=</span> rsa.<span class="command">generate_private_key</span>(public_exponent <span class="sign">=</span> 65537, key_size <span class="sign">=</span> 2048) <span class="comment"># generating a 2048-bit RSA private key using a secure RNG (Random Number Generator)</span>
public_key <span class="sign">=</span> private_key.<span class="command">public_key</span>() <span class="comment"># deriving the public key from the private key</span>

<span class="comment">#### Serializing keys (converting the state of an object into a format that can be easily stored and reused) ####</span>

<span class="comment"># Converting the private key to the PEM (Privacy-Enhanced Mail) format (encrypted storage is recommended in real systems - NoEncryption used for demonstration)</span>
private_pem <span class="sign">=</span> private_key.<span class="command">private_bytes</span>(encoding <span class="sign">=</span> serialization.<span class="function">Encoding</span>.<span class="function">PEM</span>, format <span class="sign">=</span> serialization.<span class="function">PrivateFormat</span>.<span class="function">PKCS8</span>, encryption_algorithm <span class="sign">=</span> serialization.<span class="function">NoEncryption</span>())
public_pem <span class="sign">=</span> public_key.<span class="command">public_bytes</span>(encoding <span class="sign">=</span> serialization.<span class="function">Encoding</span>.<span class="function">PEM</span>, format <span class="sign">=</span> serialization.<span class="function">PublicFormat</span>.<span class="function">SubjectPublicKeyInfo</span>) <span class="comment"># converting public key to PEM format (safe to share)</span>

<span class="comment">#### Deserializing keys ####</span>

loaded_public_key <span class="sign">=</span> serialization.<span class="command">load_pem_public_key</span>(public_pem)
loaded_private_key <span class="sign">=</span> serialization.<span class="command">load_pem_private_key</span>(private_pem, password <span class="sign">=</span> <span class="function">None</span>)

<span class="comment">#### Encrypting and decrypting a message using the public key ####</span>

message <span class="sign">=</span> <span class="text">"Hello asymmetric world!"</span>
ciphertext <span class="sign">=</span> public_key.<span class="command">encrypt</span>(message.<span class="command">encode</span>(), padding.<span class="function">OAEP</span>(mgf <span class="sign">=</span> padding.<span class="function">MGF1</span>(algorithm <span class="sign">=</span> hashes.<span class="function">SHA256</span>()), algorithm <span class="sign">=</span> hashes.<span class="function">SHA256</span>(), label <span class="sign">=</span> <span class="function">None</span>)) <span class="comment"># OAEP = secure padding scheme, .encode() converts string to bytes</span>
plaintext <span class="sign">=</span> private_key.<span class="command">decrypt</span>(ciphertext, padding.<span class="function">OAEP</span>(mgf <span class="sign">=</span> padding.<span class="function">MGF1</span>(algorithm <span class="sign">=</span> hashes.<span class="function">SHA256</span>()), algorithm <span class="sign">=</span> hashes.<span class="function">SHA256</span>(), label <span class="sign">=</span> <span class="function">None</span>)).<span class="command">decode</span>()

<span class="command">print</span>(<span class="text">"Original message:"</span>, message)
<span class="command">print</span>(<span class="text">"Decrypted message:"</span>, plaintext)
                                    </code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; CPUcademy All Rights Reserved | <a href="license-and-sources.html" class="link">License &amp; Sources</a></span>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="configs/jquery/jquery.min.js"></script>
    <script src="configs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="configs/script.js"></script>
</body>
</html>