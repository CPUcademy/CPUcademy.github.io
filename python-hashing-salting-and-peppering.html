<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="If you're looking for concise and on-topic programming tutorials and notes with examples, you are in the right place! Here, you'll find tutorials on Python, Java, C++, web development, and databases. This website is a personal portfolio built and maintained by a single creator.">
    <meta name="keywords" content="Programming, Coding, Python, Web Development, C++, HTML Tutorial, CSS Tutorial, Bootstrap Tutorial, Python Tutorial, C++ Tutorial, HTML, CSS, Bootstrap, Software Development, Algorithms, Data Structures, Programming Tutorials, Coding Tips, Code Examples, Programming Resources, Learn Python, Programming Beginner To Expert, Coding Community, Online Coding Courses, MS Access, Databases, OOP, Object Oriented Programming, IT, Computer Science, Data Science, AI, Django, TensorFlow, Java, Java Tutorial, Android, Android Studio, Kotlin, Electronics, Binary">
    <meta name="author" content="Tymoteusz Kołodziejczyk">
    <link href="font/css/all.min.css" rel="stylesheet" type="text/css">
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">
    <link href="files/logo.png" rel="icon">
    <link href="files/logo.png" rel="apple-touch-icon">
    <link rel="stylesheet" href="css/fontello.css" type="text/css">
    <link rel="stylesheet" href="css/styles.css" type="text/css">
    <title>Hashing, salting, and peppering</title>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-D76ZFDYLCY"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-D76ZFDYLCY');
    </script>
</head>

<body id="page-top">
    <div id="wrapper">
        <ul class="navbar-nav sidebar sidebar-dark accordion" id="accordionSidebar" style="background-color: #157267;">
            <a class="sidebar-brand d-flex align-items-center justify-content-center" href="index.html">
                    <img src="files/logo.png" alt="Logo" id="logo">
                <div class="sidebar-brand-text mx-3">CPUcademy</div>
            </a>
            
            <hr class="sidebar-divider my-0">
            <li class="nav-item active">
                <a class="nav-link" href="index.html">
                    <i class="icon-home"></i>
                    <span>Home</span></a>
            </li>
            <hr class="sidebar-divider" style="margin-bottom: 0px;">
    
            <li class="nav-item">
                <a class="nav-link collapsed" href="#" data-toggle="collapse" data-target="#collapseTwo"
                    aria-expanded="true" aria-controls="collapseTwo">
                    <i class="icon-th-list"></i>
                    <span>Tutorials</span>
                </a>
                <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-parent="#accordionSidebar">
                    <div class="bg-white py-2 collapse-inner rounded">
                        <a class="collapse-item" href="python.html">Python</a>
                        <a class="collapse-item" href="java.html">Java &amp; Android</a>
                        <a class="collapse-item" href="cplusplus.html">C++</a>
                        <a class="collapse-item" href="web.html">Basic web stack</a>
                        <a class="collapse-item" href="databases.html">Databases</a>
                        <a class="collapse-item" href="electronics-and-it-basics.html">Electronics &amp; IT basics</a>
                    </div>
                </div>
            </li>
            <hr class="sidebar-divider my-0">
            <li class="nav-item">
                <a class="nav-link" href="about-me.html">
                    <i class="icon-adult"></i>
                    <span>About me</span></a>
            </li>
            <hr class="sidebar-divider my-0">
            <li class="nav-item">
                <a class="nav-link" href="portfolio-projects.html">
                    <i class="icon-docs"></i>
                    <span>Portfolio projects</span></a>
            </li>
            <hr class="sidebar-divider">
        </ul>

        <div id="content-wrapper" class="d-flex flex-column">
            <div id="content">
                <button id="sidebarToggleTop" class="btn btn-link d-md-none rounded-circle mr-3">
                    <i class="fa fa-bars" style="color: #157267;"></i>
                </button>

                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12 mb-4">
                            <div class="card shadow mb-4">
                                <div class="card-header py-3">
                                    <h5 class="m-0 font-weight-bold">Hashing, salting, and peppering</h5>
                                </div>
                                <div class="card-body">
                                    <p>Hashing is a one-way transformation used to securely store sensitive values such as passwords. In Python, secure hashing is typically done using the <code>hashlib</code> module, but hashing alone is not enough. To defend against rainbow tables (precomputed tables that map plaintext passwords to their hash values to enable fast reverse lookups of hashes), a unique <b>salt</b> is added to each password before hashing. The salt is stored <b>alongside the hash in the database</b>, ensuring that identical passwords produce different hashes while still allowing verification. A <b>pepper</b> is an additional secret value added to the password during hashing, but unlike the salt, the pepper is <b>not stored in the database</b>. Instead, it is kept in a secure location such as an environment variable, configuration file, or key vault. The database, therefore, stores only the hash and the salt, while the pepper remains hidden from attackers even if the database is compromised.</p>

                                    <p>Hashed passwords cannot be decrypted, because hashing is a one‑way operation that permanently transforms the original password into a fixed-length digest with no mathematical method to reverse it. Instead of decrypting, password systems verify a login attempt by hashing the user’s input again using the same salt and pepper, then comparing the result to the stored hash. If the two hashes match, the password is correct. This design ensures that even if an attacker gains access to the database, they cannot recover the original passwords, because only the hash and salt are stored in the database, while the pepper remains securely stored in an environment variable or key vault.</p>

                                    <pre class="wp-block-csstricks-code-block code-example" data-line="" style="color: #EFEEEE;"><code markup="tt">
<span class="command">import</span> os, hashlib, hmac, base64
<span class="command">from</span> secrets <span class="command">import</span> token_bytes

salt <span class="sign">=</span> token_bytes(16) <span class="comment"># generating a random salt for each password</span>
pepper <span class="sign">=</span> os.<span class="command">environ</span>.<span class="command">get</span>(<span class="text">"PEPPER_SECRET"</span>, <span class="text">"default_pepper"</span>).<span class="command">encode</span>() <span class="comment"># a secret pepper stored securely (e.g., an environment variable)</span>

<span class="comment"># Hashing a password with SHA-256 + salt + pepper</span>
password <span class="sign">=</span> <span class="text">"my_secure_password"</span>.<span class="command">encode</span>()
combined <span class="sign">=</span> salt <span class="sign">+</span> password <span class="sign">+</span> pepper
hash_value <span class="sign">=</span> hashlib.<span class="command">sha256</span>(combined).<span class="command">hexdigest</span>()
<span class="command">print</span>(hash_value)

<span class="comment"># Saving hash and salt for later (simulated storage example)</span>
stored_salt <span class="sign">=</span> base64.<span class="command">b64encode</span>(salt).<span class="command">decode</span>() <span class="comment"># encoding salt for storage (e.g., database, file)</span>
stored_hash <span class="sign">=</span> hash_value

<span class="comment">#### Later ####</span>

<span class="function">def</span> verify_password(stored_hash, salt, password):
    combined <span class="sign">=</span> salt <span class="sign">+</span> password.<span class="command">encode</span>() <span class="sign">+</span> pepper
    new_hash <span class="sign">=</span> hashlib.<span class="command">sha256</span>(combined).<span class="command">hexdigest</span>()
    <span class="function">return</span> hmac.<span class="command">compare_digest</span>(stored_hash, new_hash)

loaded_salt <span class="sign">=</span> base64.<span class="command">b64decode</span>(stored_salt) <span class="comment"># loading and decoding stored salt</span>
<span class="command">print</span>(verify_password(stored_hash, loaded_salt, <span class="text">"my_secure_password"</span>))
                                    </code></pre>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <footer class="sticky-footer bg-white">
                <div class="container my-auto">
                    <div class="copyright text-center my-auto">
                        <span>Copyright &copy; CPUcademy All Rights Reserved | <a href="license-and-sources.html" class="link">License &amp; Sources</a></span>
                    </div>
                </div>
            </footer>
        </div>
    </div>
    <script src="configs/jquery/jquery.min.js"></script>
    <script src="configs/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="configs/script.js"></script>
</body>
</html>